
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>旗遇世界：國旗大冒險</title>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/nes.css@2.3.0/css/nes.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css">
</head>
<body style="font-family: 'Noto Sans TC', 'Press Start 2P', sans-serif; background-color: #209cee;">
    <!-- 品牌標誌 -->
    <div class="brand-logo">VIBECODING GAMES BY SABRINA</div>

    <div class="container nes-container is-dark">
        <!-- 音效開關按鈕 -->
        <button id="sound-toggle" class="nes-btn sound-toggle" onclick="toggleSound()" title="點擊關閉音效">
            <i class="nes-icon is-small heart"></i>
        </button>

        <!-- 世界地圖按鈕 -->
        <button id="map-toggle" class="nes-btn map-toggle" onclick="showWorldMap()" title="查看已解鎖的世界地圖">
            <i class="nes-icon is-small star"></i>
        </button>

        <h1 id="page-title">
            <i class="nes-icon trophy is-small"></i>
            旗遇世界
            <i class="nes-icon trophy is-small"></i>
        </h1>

        <!-- 遊戲開始畫面 -->
        <div id="start-screen">
            <div class="welcome-text">
                <h2 id="welcome-title">歡迎來到旗遇世界！</h2>
                <p id="welcome-subtitle">「知識，就是你的護照。一起環遊世界，收集所有光榮。」</p>

                <!-- 名稱輸入 -->
                <div class="name-input-section nes-field">
                    <label id="name-label" for="name-input">玩家名稱：</label>
                    <input type="text" id="name-input" class="nes-input" placeholder="輸入名稱" maxlength="20">
                </div>

                <button id="enter-stage-btn" class="nes-btn is-primary btn" onclick="enterStageSelect()">
                    <i class="nes-icon coin is-small"></i> 進入闖關
                </button>
                <button id="daily-challenge-btn" class="nes-btn is-warning btn" onclick="startDailyChallenge()">
                    <i class="nes-icon star is-small"></i> <span id="daily-challenge-text">每日挑戰</span>
                    <span id="daily-status" class="daily-status"></span>
                </button>
                <button id="clear-progress-btn" class="nes-btn is-error btn" onclick="ProgressManager.clearAllProgress()">
                    <span id="clear-progress-text">清除進度</span>
                </button>
            </div>
        </div>

        <!-- 關卡選擇畫面 -->
        <div id="stage-select-screen" class="hidden">
            <h2 id="stage-select-title">🎯 選擇關卡</h2>
            <p id="stage-select-subtitle">通過每個關卡解鎖下一關！</p>

            <div id="stages-container" class="stages-container">
                <!-- 關卡將由 JavaScript 動態生成 -->
            </div>

            <button id="back-to-start-btn" class="nes-btn btn" onclick="backToStart()">返回</button>
        </div>

        <!-- 遊戲進行畫面 -->
        <div id="game-screen" class="hidden">
            <!-- 關卡資訊 -->
            <div class="stage-info-banner">
                <span id="stage-number">第 1 關</span>
                <span class="separator">|</span>
                <span id="stage-name">新手訓練營</span>
            </div>

            <!-- 遊戲狀態列 -->
            <div class="game-status">
                <div class="status-item">
                    <span class="label" id="question-label">題號：</span>
                    <span id="question-number">1</span>/<span id="total-questions">10</span>
                </div>
                <div class="status-item">
                    <span class="label" id="score-label">得分：</span>
                    <span id="current-score">0</span>
                </div>
                <div class="status-item">
                    <span class="label" id="lives-label">剩餘機會：</span>
                    <span id="lives">❤️❤️❤️</span>
                </div>
                <div class="status-item">
                    <span class="label" id="max-score-label">本題最高分：</span>
                    <span id="max-score">10</span>
                </div>
            </div>

            <!-- 國旗顯示區 -->
            <div class="flag-display">
                <div id="flag-emoji">🇹🇼</div>
                <p class="question-text" id="question-text">請猜猜這是哪個國家的國旗？</p>
            </div>

            <!-- 提示區域 -->
            <div id="hints-area" class="hints-area">
                <div id="hint1" class="hint hidden"></div>
                <div id="hint2" class="hint hidden"></div>
                <div id="hint3" class="hint hidden"></div>
            </div>

            <!-- 回饋訊息區 -->
            <div id="feedback" class="feedback hidden"></div>

            <!-- 選項按鈕區 -->
            <div class="options-area" id="options-area">
                <!-- 選項將由 JavaScript 動態生成 -->
            </div>

            <!-- 提示按鈕區 -->
            <div class="hint-buttons">
                <button id="hint-btn-1" class="nes-btn is-warning btn btn-hint" onclick="showHint(1)">
                    <i class="nes-icon coin is-small"></i> 提示 1
                </button>
                <button id="hint-btn-2" class="nes-btn is-warning btn btn-hint" onclick="showHint(2)">
                    <i class="nes-icon coin is-small"></i> 提示 2
                </button>
                <button id="hint-btn-3" class="nes-btn is-warning btn btn-hint" onclick="showHint(3)">
                    <i class="nes-icon coin is-small"></i> 提示 3
                </button>
            </div>

            <!-- 下一題和停止按鈕 -->
            <div class="game-control-buttons">
                <button id="next-btn" class="nes-btn is-success btn btn-primary hidden" onclick="nextQuestion()">下一題</button>
                <button id="quit-btn" class="nes-btn is-error btn btn-secondary" onclick="quitChallenge()">停止</button>
            </div>
        </div>

        <!-- 遊戲結束畫面 -->
        <div id="end-screen" class="hidden">
            <h2 id="end-title">遊戲結束！</h2>
            <div class="final-result">
                <div class="final-score">
                    <h3 id="final-score-label">最終得分</h3>
                    <div id="final-score-value">0</div>
                </div>
                <div class="title-section">
                    <h3 id="title-label">您的國旗頭銜</h3>
                    <div id="title-badge"></div>
                    <p id="title-description"></p>
                </div>
            </div>
            <div class="end-buttons">
                <button id="next-stage-btn" class="nes-btn is-success btn btn-primary hidden" onclick="goToNextStage()">
                    <i class="nes-icon star is-small"></i> 下一關
                </button>
                <button id="back-to-stage-btn" class="nes-btn is-primary btn" onclick="backToStageSelect()">返回選關</button>
                <button id="share-game-btn" class="nes-btn btn" onclick="shareGame()">
                    <i class="nes-icon like is-small"></i> 分享
                </button>
            </div>
        </div>

        <!-- 排行榜畫面 -->
        <div id="leaderboard-screen" class="hidden">
            <h2 id="leaderboard-title">🏆 排行榜</h2>

            <!-- 難度選擇器 -->
            <div class="leaderboard-filter" role="group">
                <button class="nes-btn filter-btn active" onclick="filterLeaderboard('all', this)">
                    <span id="filter-all">全部</span>
                </button>
                <button class="nes-btn filter-btn" onclick="filterLeaderboard('beginner', this)">
                    <span id="filter-beginner">初級</span>
                </button>
                <button class="nes-btn filter-btn" onclick="filterLeaderboard('intermediate', this)">
                    <span id="filter-intermediate">中級</span>
                </button>
                <button class="nes-btn filter-btn" onclick="filterLeaderboard('advanced', this)">
                    <span id="filter-advanced">高級</span>
                </button>
            </div>

            <div class="leaderboard-content">
                <table id="leaderboard-table" class="nes-table is-bordered is-centered">
                    <thead>
                        <tr>
                            <th>排名</th>
                            <th>玩家</th>
                            <th>難度</th>
                            <th>得分</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- 排行榜數據將由 JavaScript 動態生成 -->
                    </tbody>
                </table>
            </div>
            <button id="back-btn" class="nes-btn is-primary btn" onclick="backToStart()">返回</button>
        </div>

        <!-- 世界地圖畫面 -->
        <div id="world-map-screen" class="hidden">
            <h2>🗺️ 世界地圖解鎖進度</h2>
            <p class="map-subtitle">通過關卡，逐步解鎖全世界！</p>

            <div class="world-map-container">
                <!-- 世界地圖圖片 -->
                <div class="world-map-image">
                    <img src="world-map.jpg" alt="世界地圖" class="map-background">

                    <!-- 已解鎖國家的圖釘標記層 -->
                    <div class="map-pins" id="map-pins-container"></div>

                    <!-- 可點擊的大洲區域覆蓋層 -->
                    <div class="map-overlay">
                        <!-- 北美洲 -->
                        <div id="region-north-america" class="region-overlay" data-region="北美洲" style="left: 8%; top: 25%; width: 18%; height: 35%;">
                            <div class="region-info">
                                <div class="region-label">北美洲</div>
                                <div class="region-progress-text">0/20</div>
                            </div>
                        </div>

                        <!-- 南美洲 -->
                        <div id="region-south-america" class="region-overlay" data-region="南美洲" style="left: 18%; top: 55%; width: 14%; height: 30%;">
                            <div class="region-info">
                                <div class="region-label">南美洲</div>
                                <div class="region-progress-text">0/20</div>
                            </div>
                        </div>

                        <!-- 歐洲 -->
                        <div id="region-europe" class="region-overlay" data-region="歐洲" style="left: 44%; top: 18%; width: 12%; height: 20%;">
                            <div class="region-info">
                                <div class="region-label">歐洲</div>
                                <div class="region-progress-text">0/20</div>
                            </div>
                        </div>

                        <!-- 非洲 -->
                        <div id="region-africa" class="region-overlay" data-region="非洲" style="left: 43%; top: 40%; width: 16%; height: 35%;">
                            <div class="region-info">
                                <div class="region-label">非洲</div>
                                <div class="region-progress-text">0/20</div>
                            </div>
                        </div>

                        <!-- 亞洲 -->
                        <div id="region-asia" class="region-overlay" data-region="亞洲" style="left: 58%; top: 15%; width: 28%; height: 45%;">
                            <div class="region-info">
                                <div class="region-label">亞洲</div>
                                <div class="region-progress-text">0/20</div>
                            </div>
                        </div>

                        <!-- 大洋洲 -->
                        <div id="region-oceania" class="region-overlay" data-region="大洋洲" style="left: 75%; top: 65%; width: 15%; height: 20%;">
                            <div class="region-info">
                                <div class="region-label">大洋洲</div>
                                <div class="region-progress-text">0/20</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="unlock-stats">
                    <h3>解鎖統計</h3>
                    <div class="stat-item">
                        <span>通過關卡：</span>
                        <span id="stages-completed">0 / 20</span>
                    </div>
                    <div class="stat-item">
                        <span>已解鎖國家：</span>
                        <span id="countries-unlocked">0 / 87</span>
                    </div>
                    <div class="stat-item">
                        <span>總完成度：</span>
                        <span id="total-completion">0%</span>
                    </div>
                </div>

                <!-- 已解鎖國家展示 -->
                <div class="unlocked-countries">
                    <h3>🎉 已解鎖國家</h3>
                    <div id="unlocked-flags-container" class="unlocked-flags-grid">
                        <!-- 國旗將由 JavaScript 動態生成 -->
                    </div>
                </div>
            </div>

            <button id="back-from-map-btn" class="nes-btn is-primary btn" onclick="closeWorldMap()">返回</button>
        </div>
    </div>

    <script src="script.js?v=20241207001"></script>
</body>
</html>
